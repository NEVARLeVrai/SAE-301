{% extends 'base.twig' %}

{% block title %} - Devenir contributeur{% endblock %}

{% block content %}
<h1>Devenir Contributeur</h1>
<p>Vous souhaitez contribuer √† OmniMusique ? Faites une demande pour obtenir un r√¥le de r√©dacteur ou musicien.</p>

{% if success is defined and success %}
    <div class="alert alert-success">{{ success }}</div>
{% endif %}

{% if error is defined and error %}
    <div class="alert alert-danger">{{ error }}</div>
{% endif %}

{% if hasPending %}
    <div class="alert alert-warning">
        <i class="bi bi-hourglass-split me-2"></i>
        Vous avez d√©j√† une demande en cours de traitement. Veuillez patienter.
    </div>
{% else %}

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <h2>Faire une demande</h2>
            
            <form action="index.php?action=request_role" method="POST">
                <div class="mb-3">
                    <label class="form-label">Quel r√¥le souhaitez-vous ?</label>
                    <select name="requested_role" class="form-control" required>
                        <option value="">-- Choisissez --</option>
                        <option value="redacteur">‚úçÔ∏è R√©dacteur - Pour √©crire des articles de blog</option>
                        <option value="musicien">üé∏ Musicien Professionnel - Pour vendre vos compositions</option>
                    </select>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Motivation (optionnel)</label>
                    <textarea name="motivation" class="form-control" rows="5" 
                              placeholder="Expliquez pourquoi vous souhaitez obtenir ce r√¥le, votre exp√©rience, etc."></textarea>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-send me-1"></i> Envoyer ma demande
                </button>
            </form>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card bg-light">
            <h3>Les r√¥les</h3>
            
            <h4><i class="bi bi-pencil-square text-info me-1"></i> R√©dacteur</h4>
            <ul>
                <li>R√©diger des articles de blog</li>
                <li>Mod√©rer les commentaires</li>
                <li>G√©rer ses propres contenus</li>
            </ul>
            
            <h4><i class="bi bi-music-note text-success me-1"></i> Musicien Pro</h4>
            <ul>
                <li>Vendre vos compositions</li>
                <li>Cr√©er des cours de musique</li>
                <li>Suivre vos statistiques de vente</li>
            </ul>
        </div>
    </div>
</div>

{% endif %}

{# Historique de mes demandes #}
{% if myRequests|length > 0 %}
<div class="card mt-3">
    <h2>Mes demandes pr√©c√©dentes</h2>
    <table class="table">
        <thead>
            <tr>
                <th>R√¥le demand√©</th>
                <th>Statut</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for req in myRequests %}
                <tr>
                    <td>{{ req.requested_role|capitalize }}</td>
                    <td>
                        {% if req.status == 'pending' %}
                            <span class="badge bg-warning">En attente</span>
                        {% elseif req.status == 'approved' %}
                            <span class="badge bg-success">Approuv√©</span>
                        {% else %}
                            <span class="badge bg-danger">Rejet√©</span>
                        {% endif %}
                    </td>
                    <td>{{ req.created_at|date('d/m/Y') }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
